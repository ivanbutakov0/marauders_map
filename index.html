<!DOCTYPE html>
<html lang="en">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />
		<title>Document</title>
	</head>
	<link rel="stylesheet" href="styles.css" />
	<body>
		<h1>Marauder's map</h1>

		<canvas id="myCanvas"></canvas>
		<div id="controls">
			<button onclick="addRandomNode()">Add node</button>
			<button onclick="addRandomLink()">Add link</button>
			<button onclick="removeRandomLink()">Remove link</button>
			<button onclick="removeRandomNode()">Remove node</button>
			<button onclick="removeAll()">Remove all</button>
		</div>

		<script src="js/math/graph.js"></script>
		<script src="js/primitives/node.js"></script>
		<script src="js/primitives/link.js"></script>
		<script>
			function removeAll() {
				graph.dispose()
				ctx.clearRect(0, 0, myCanvas.width, myCanvas.height)
				graph.draw(ctx)
			}

			function removeRandomNode() {
				const randomNodeIndex = Math.floor(Math.random() * graph.nodes.length)

				graph.removeNode(randomNodeIndex)
				ctx.clearRect(0, 0, myCanvas.width, myCanvas.height)
				graph.draw(ctx)
			}

			function removeRandomLink() {
				const randomLinkIndex = Math.floor(Math.random() * graph.links.length)

				graph.removeLink(randomLinkIndex)
				ctx.clearRect(0, 0, myCanvas.width, myCanvas.height)
				graph.draw(ctx)
			}

			function addRandomLink() {
				const node1 =
					graph.nodes[Math.floor(Math.random() * graph.nodes.length)]
				const node2 =
					graph.nodes[Math.floor(Math.random() * graph.nodes.length)]

				const success = graph.tryAddLink(new Link(node1, node2))
				ctx.clearRect(0, 0, myCanvas.width, myCanvas.height)
				graph.draw(ctx)
				console.log(success)
			}

			function addRandomNode() {
				const success = graph.tryAddNode(
					new Node(
						Math.random() * myCanvas.width,
						Math.random() * myCanvas.height
					)
				)

				console.log(success)

				ctx.clearRect(0, 0, myCanvas.width, myCanvas.height)
				graph.draw(ctx)
			}

			myCanvas.width = 700
			myCanvas.height = 500

			const ctx = myCanvas.getContext('2d')

			const node1 = new Node(100, 100)
			const node2 = new Node(200, 200)
			const node3 = new Node(300, 200)
			const node4 = new Node(400, 100)

			const link1 = new Link(node1, node2)
			const link2 = new Link(node2, node3)
			const link3 = new Link(node3, node4)

			const graph = new Graph(
				[node1, node2, node3, node4],
				[link1, link2, link3]
			)
			graph.draw(ctx)
		</script>
	</body>
</html>
